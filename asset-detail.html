<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi ti·∫øt Asset</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #ece9e6, #ffffff);
            color: #333;
        }
        .card {
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 20px;
            overflow: hidden;
            transition: transform 0.3s;
        }
        .card:hover {
            transform: translateY(-10px);
        }
        .card-body {
            background: #f0f4f7;
        }
        #assetImage {
            border-bottom: 2px solid #007bff;
            border-radius: 20px 20px 0 0;
        }
        .btn-success {
            background: linear-gradient(135deg, #28a745, #218838);
            border: none;
            box-shadow: 0 4px 6px rgba(40, 167, 69, 0.3);
            transition: transform 0.2s;
        }
        .btn-success:hover {
            transform: scale(1.05);
        }
        #adsContainer .alert {
            background-color: #fff3cd;
            color: #856404;
            border-radius: 15px;
        }
    </style>
</head>
<body class="p-4">

<div class="container">
    <a href="index.html" class="btn btn-outline-secondary mb-4">‚¨ÖÔ∏è Quay l·∫°i</a>

    <div id="assetDetail" class="card">
        <img id="assetImage" class="card-img-top" src="" alt="Asset Image" style="width: 30%; height: auto; object-fit: contain; margin: auto;">
        <div class="card-body text-center">
            <h3 id="assetName" class="card-title mb-3"></h3>
            <p id="assetDesc" class="card-text mb-4"></p>

            <!-- Khu v·ª±c qu·∫£ng c√°o v·ªõi b·ªô ƒë·∫øm th·ªùi gian -->
            <div id="adsContainer" class="my-3">
                <div class="alert alert-warning text-center" id="adMessage">
                    ‚è≥ Vui l√≤ng ch·ªù <span id="countdown">30</span> gi√¢y ƒë·ªÉ m·ªü kh√≥a n√∫t t·∫£i...
                </div>
            </div>

            <a id="downloadLink" href="#" class="btn btn-success px-4 py-2" style="display: none;" target="_blank">üîΩ T·∫£i xu·ªëng</a>
        </div>
    </div>
</div>

<script>
    // L·∫•y ID asset t·ª´ URL
    const urlParams = new URLSearchParams(window.location.search);
    const assetId = parseInt(urlParams.get('id'));

    // L·∫•y d·ªØ li·ªáu asset t·ª´ localStorage
    const assets = JSON.parse(localStorage.getItem('assets')) || [];
    const asset = assets.find(item => item.id === assetId);

    // Hi·ªÉn th·ªã chi ti·∫øt asset n·∫øu t√¨m th·∫•y
    if (asset) {
        document.getElementById('assetName').textContent = asset.name;
        document.getElementById('assetDesc').textContent = asset.description;

        // X·ª≠ l√Ω URL Google Drive n·∫øu c·∫ßn
        let imageUrl = asset.image;
        const googleDrivePattern = /^https:\/\/drive\.google\.com\/file\/d\/(.+?)\/view/;
        const match = imageUrl.match(googleDrivePattern);
        if (match) {
            const fileId = match[1];
            imageUrl = `https://drive.google.com/thumbnail?id=${fileId}&sz=w1000`;
        }

        document.getElementById('assetImage').src = imageUrl;
        document.getElementById('assetImage').alt = asset.name;
        document.getElementById('downloadLink').href = asset.download;

        // B·∫Øt ƒë·∫ßu b·ªô ƒë·∫øm th·ªùi gian 30 gi√¢y
        let timeLeft = 30;
        const countdownElement = document.getElementById('countdown');
        const adMessage = document.getElementById('adMessage');

        const timer = setInterval(() => {
            timeLeft--;
            countdownElement.textContent = timeLeft;

            if (timeLeft <= 0) {
                clearInterval(timer);
                document.getElementById('downloadLink').style.display = 'inline-block';
                adMessage.style.display = 'none';
                alert('Qu·∫£ng c√°o ƒë√£ k·∫øt th√∫c. Link t·∫£i ƒë√£ ƒë∆∞·ª£c m·ªü kh√≥a!');
            }
        }, 1000);

    } else {
        document.getElementById('assetDetail').innerHTML = `<div class="alert alert-danger text-center">Kh√¥ng t√¨m th·∫•y asset!</div>`;
    }
</script>

</body>
</html>
